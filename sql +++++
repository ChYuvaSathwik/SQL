customers
id	name	city
1	Rahul	Delhi
2	Anita	Mumbai
3	Suresh	Chennai
4	Priya	Delhi
5	Ramesh	Kolkata
orders
id	customer_id	product	amount
101	1	Laptop	50000
102	1	Phone	20000
103	2	TV	40000
104	3	Laptop	55000
105	3	Mouse	5000
106	4	Phone	25000
payments
id	order_id	payment_status
201	101	Completed
202	102	Pending
203	103	Completed
204	104	Completed
205	105	Pending
206	106	Completed



1. Show all customers and their orders, even if they have no orders
SELECT t1.name, t2.product
FROM customers AS t1
LEFT JOIN orders AS t2
ON t1.id = t2.customer_id;

2. Show customers who have not placed any orders
SELECT t1.name
FROM customers AS t1
LEFT JOIN orders AS t2
ON t1.id = t2.customer_id
WHERE t2.customer_id IS NULL;

3. Show all orders and their payment status, even if payment is not done yet
SELECT t1.product, t2.payment_status
FROM orders AS t1
LEFT JOIN payments AS t2
ON t1.id = t2.order_id;

4. Show all customers and total amount spent, customers with no orders should show 0
SELECT t1.name, COALESCE(SUM(t2.amount), 0) AS total_amount_spent
FROM customers AS t1
LEFT JOIN orders AS t2
ON t1.id = t2.customer_id
GROUP BY t1.id, t1.name;

5. Show customers and number of orders, customers with no orders should show 0
SELECT t1.name, COALESCE(COUNT(t2.customer_id), 0) AS number_of_orders
FROM customers AS t1
LEFT JOIN orders AS t2
ON t1.id = t2.customer_id
GROUP BY t1.id, t1.name;

9. Show customers who have both Laptop and Phone orders
SELECT t1.name
FROM customers AS t1
INNER JOIN orders AS t2
ON t1.id = t2.customer_id
WHERE t2.product IN ('Laptop','Phone')
GROUP BY t1.id, t1.name
HAVING COUNT(DISTINCT t2.product) = 2;

10. Show top 2 customers who spent the most
SELECT t1.name, SUM(t2.amount) AS total_amount_spent
FROM customers AS t1
INNER JOIN orders AS t2
ON t1.id = t2.customer_id
GROUP BY t1.id, t1.name
ORDER BY SUM(t2.amount) DESC
LIMIT 2;
